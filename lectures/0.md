---
title: Методы выпуклой оптимизации. Поток 2. Правила курса
author: Даня Меркулов
institute: ЦУ
format: 
    beamer:
        pdf-engine: xelatex
        aspectratio: 169
        fontsize: 9pt
        section-titles: false
        incremental: true
        include-in-header: ../files/xeheader.tex  # Custom LaTeX commands and preamble
header-includes:
  - \newcommand{\bgimage}{../files/back0.jpeg}
---

## Общая информация о курсе

::::{.columns}
:::{.column width="40%"}
![](nag_gs.pdf)
:::
:::{.column width="60%"}

* Бакалавриат:
  * Лектор - Меркулов Даниил Максимович (Сколтех, AI4Science Сбер, МФТИ, ФКН ВШЭ)
  * Семинарист  - Денис Рубцов (МФТИ, Сколтех)
  * Курс для студентов 2 курса ЦУ. 1 лекция + 1 семинар в неделю
  * Старт учебной недели - 8 сентября. Длительность 15 недель
* Магистратура:
  * Лектор/семинарист - Остроухов Петр Алексеевич (МФТИ, ИСП РАН)
  * Курс для студентов 1 курса магистратуры ЦУ. 1 лекция + 1 семинар в неделю
  * Старт учебной недели - 1 сентября. Длительность 15 недель
* Курс охватывает темы выпуклой, невыпуклой, непрерывной оптимизации, особенно мотивированные задачами и приложениями в машинном обучении. Рассматриваются разные темы - от фундаментальных материалов до недавних исследований
:::
::::

# Программа курса

## База 1

::::{.columns}
:::{.column width="40%"}
![](ls.pdf)
:::
:::{.column width="60%"}

* Вспоминаем линейную алгебру. Скорость сходимости последовательностей / Матричные вычисления, нормы, LoRA, анализ сходимости с помощью тестов корней и отношений
* Одномерная оптимизация. Неточная одномерная оптимизация. Градиент. Гессиан. Матрично-векторное дифференцирование.
* Автоматическое дифференцирование. Вычислительный граф.
:::

::::

## База 2

::::{.columns}
:::{.column width="40%"}
![](pl_3d.pdf)
:::
:::{.column width="60%"}

* Выпуклость. Выпуклые множества. Выпуклые функции. Неравенство Йенсена. Сильно выпуклые функции. Условие Поляка - Лоясиевича. Минимумы линейных нейронных сетей.
* Условия оптимальности. Функция Лагранжа. Задачи с ограничениями-равенствами. Задачи с ограничениями-неравенствами. Теорема Каруша - Куна - Таккера.
* Линейное программирование, симплекс метод / Производственное планирование, транспортная задача

:::

::::

## Золотая классика численных методов оптимизации

::::{.columns}
:::{.column width="25%"}
![](GD_HB.pdf)
:::
:::{.column width="75%"}

* Градиентный спуск и анализ сходимости / Стратегии выбора шага, PL-условие
* Ускоренные градиентные методы
* Метод сопряжённых градиентов для линейной системы, нелинейный CG
* Метод Ньютона и квази-Ньютон, BFGS, L-BFGS
* Градиентные методы для условных задач

:::

::::

## Продвинутые методы и современные задачи ML

::::{.columns}
:::{.column width="40%"}
![](noshortLog.png)
:::
:::{.column width="60%"}
* Методы оптимизации для негладких задач
* Методы минимизации конечной суммы для задач ML (SGD)
* Современные методы оптимизации для задач обучения нейронных сетей

:::

::::



# Формальные вопросы

## Оценивание

Оценка за курс вычисляется по следующей формуле:
$$
\text{grade} = \text{round}\left(\min\left(10, \begin{bmatrix}
    0.40 \\ 0.25 \\ 0.10 \\ 0.35
\end{bmatrix}^T \begin{bmatrix}
    \text{Контрольные работы} \\ \text{Домашние задания} \\ \text{Тесты на семинарах} \\ \text{Экзамен}
\end{bmatrix}\right)\right)
$$

* **Контрольные работы (40%)** - письменная работа с набором задач, которые нужно решить за ограниченное время.
* **Домашние задания (25%)** - задачи по темам недели для самостоятельного решения. 
* **Тесты на семинарах (10%)** - набор задач по темам недели для решения на семинарах
* **Экзамен (35%)** - устный экзамен по материалам курса
* Первые две недели курса домашние задания и тесты будут выдаваться, но **не будут учитываться в оценке**, поскольку в этот период можно перейти с одного потока на другой
* Все компоненты оцениваются от $0$ до $10$
\pause

| Контрольные работы | Домашние задания | Тесты на семинарах | Экзамен |
|:-:|:-:|:-:|:-:|
| 40% | 25% | 10% | 35% |



## Контрольные работы

* Две контрольные работы за семестр (ориентировочно на 7 и 12 неделях, но точные даты будут объявлены позднее)
* Письменные работы с набором задач, которые нужно решить за ограниченное время
* Задачи похожи на домашние задания, вплоть до того, что каждая контрольная содержит хотя бы одну задачу из домашнего задания
* Контрольные работы проводятся в очном формате, длительность - 1 пара
* На контрольных работах можно будет пользоваться рукописной (написанной вами от руки на бумаге) шпаргалкой размера одна страница А4

## Домашние задания

* Выкладываются и сдаются в LMS
* Есть практические и теоретические задания
* Дедлайны - жесткие. Убедитесь, что вы не отправляете задание в последние минуты
* При оформлении решений следует использовать машинописный формат сдачи (`quarto`, `markdown`, `latex`, `typst`).
  
  Вы можете оформлять теоретические задачи красивым понятным почерком (на планшете или на бумаге с качественным сканированием). Обратите внимание, что если сданный материал низкого качества или не читается, то ассистенты не смогут проверить его
* Домашние задания выдаются по темам лекции в понедельник. Дедлайн сдачи на каждой неделе - в ближайшее воскресенье в 22:00 по Московскому времени
* Если математическая часть решения полностью машинописная и не содержит картинок, студент сдаёт только `.ipynb` (ссылки на Google Colab не допускаются вместо файлов, следует прислать именно файл в формате `.ipynb`) 
* Если в работе есть картинки или рукописные вставки, нужно сдать `.ipynb` и тот же ноутбук, экспортированный в `.pdf`.


## Тесты на семинарах

* В начале семинара проводится тест на 10-15 минут по материалам предыдущей недели
* При решении тестовых задач нельзя пользоваться никакими источниками и средствами, кроме своей головы


## Экзамен

* Пройдёт в конце семестра (точная дата будет объявлена позднее)
* Оценка за экзамен складывается из 4 частей
  * Вопросы по формулировкам - 3 балла
  * Теорема с доказательством - 2 балла
  * Решение задачи - 3 балла
  * Дополнительный вопрос - 2 балла
* Сначала выдаются 6 случайных определения/формулировки из списка. При правильном ответе хотя бы на 3 из 6 определений/формулировок экзамен продолжается дальше, и вы получаете $x-3$ баллов, где $x$ - число верно отвеченных вопросов. В противном случае за экзамен выставляется 0 баллов.
* При успешной сдаче определений вам выдается билет, содержащий теоретический вопрос на доказательство, а также задачу. Теоретический вопрос на доказательства будет по теоремам из списка. Для подготовки к задачам советуем повторить домашние задания, а также задачи с семинаров.
В процессе беседы по предыдущим пунктам экзаменатор может задавать уточняющие вопросы. 
* После ответа на предыдущие этапы экзаменатор задает дополнительный вопрос, например, задачу или вопрос, связанный с теорией. Ответ на дополнительный вопрос оценивается в 2 балла.
* Если во время экзамена человек не может написать формулировку неравенства Йенсена для выпуклой функции, условия локального экстремума для задачи безусловной оптимизации, метод градиентного спуска, метод Ньютона, метод тяжелого шарика, что такое батч и эпоха, за экзамен ставится 0.
* Экзамен блокирующий

## Материалы

:::{.nonincremental}
* Открытый сайт с материалами курса [cu25.fmin.xyz](https://cu25.fmin.xyz)
* Boyd S. P., Vandenberghe L. Convex optimization. – Cambridge university press, 2004.
* Nocedal J., Wright S. J. (ed.). Numerical optimization. – New York, NY : Springer New York, 1999.
* Nesterov Y. et al. Lectures on convex optimization. – Berlin : Springer, 2018. – Т. 137. – С. 576.
* Жадан В. Г. Методы оптимизации. Части 1, 2, 3 //М.: МФТИ. – 2014.
:::