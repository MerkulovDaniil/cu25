---
title: "–ú–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –∏ –∫–≤–∞–∑–∏–Ω—å—é—Ç–æ–Ω–æ–≤—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã"
author: –î–∞–Ω—è –ú–µ—Ä–∫—É–ª–æ–≤, –ü–µ—Ç—Ä –û—Å—Ç—Ä–æ—É—Ö–æ–≤
institute: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö! –¶–£
format:
    pdf:
        include-in-header: ../files/longread_header.tex
        keep-tex: true
number-sections: true
---

# –ú–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞

## –ò–¥–µ—è –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞ –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –∫–æ—Ä–Ω–µ–π —Ñ—É–Ω–∫—Ü–∏–∏

:::: {.columns}

::: {.column width="60%"}
![](newton_ru.pdf)
:::

::: {.column width="40%"}
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ñ—É–Ω–∫—Ü–∏—é $\varphi(x): \mathbb{R} \to \mathbb{R}$. 


–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –≤ —Ç–æ—á–∫–µ $x_k$ –∏ –Ω–∞–π—Ç–∏ –µ–≥–æ –∫–æ—Ä–µ–Ω—å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –Ω–æ–≤–æ–π —Ç–æ—á–∫–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏:

$$
\varphi'(x_k) = \frac{\varphi(x_k)}{x_k - x_{k+1}}
$$

–ú—ã –ø–æ–ª—É—á–∞–µ–º –∏—Ç–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å—Ö–µ–º—É:


$$
x_{k+1} = x_k - \dfrac{\varphi(x_k)}{\varphi'(x_k)}.
$$

–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —Å—Ç–∞–Ω–µ—Ç –º–µ—Ç–æ–¥–æ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ù—å—é—Ç–æ–Ω–∞ –≤ —Å–ª—É—á–∞–µ $f'(x) = \varphi(x)$^[–ú—ã —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ä–µ—à–∞–µ–º –∑–∞–¥–∞—á—É –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω—ã—Ö —Ç–æ—á–µ–∫ $\nabla f(x) = 0$]:

$$
x_{k+1} = x_k - \left[ \nabla^2 f(x_k)\right]^{-1} \nabla f(x_k)
$$
:::

::::

## –ú–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –∫–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–π –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏

–ü—É—Å—Ç—å —É –Ω–∞—Å –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è $f(x)$ –∏ –Ω–µ–∫–æ—Ç–æ—Ä–∞—è —Ç–æ—á–∫–∞ $x_k$. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–∏ $x_k$:

$$
f^{II}_{x_k}(x) = f(x_k) + \langle \nabla f(x_k), x - x_k\rangle + \frac{1}{2} \langle \nabla^2 f(x_k)(x-x_k), x-x_k \rangle. 
$$


–ò–¥–µ—è –º–µ—Ç–æ–¥–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —Ç–æ—á–∫—É $x_{k+1}$, –∫–æ—Ç–æ—Ä–∞—è –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é $f^{II}_{x_k}(x)$, —Ç.–µ. $\nabla f^{II}_{x_k}(x_{k+1}) = 0$.

$$
\begin{aligned}
 \nabla f^{II}_{x_k}(x_{k+1})  &= \nabla f(x_{k}) + \nabla^2 f(x_k)(x_{k+1} - x_k) = 0 \\ 
 \nabla^2 f(x_k)(x_{k+1} - x_k) &= -\nabla f(x_{k}) \\ 
 \left[ \nabla^2 f(x_k)\right]^{-1} \nabla^2 f(x_k)(x_{k+1} - x_k) &= -\left[ \nabla^2 f(x_k)\right]^{-1} \nabla f(x_{k}) \\ 
 x_{k+1} &= x_k -\left[ \nabla^2 f(x_k)\right]^{-1} \nabla f(x_{k}). 
\end{aligned}
$$

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç–º–µ—Ç–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å—é –Ω–µ–≤—ã—Ä–æ–∂–¥–µ–Ω–Ω–æ—Å—Ç–∏ (–¥–ª—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –º–µ—Ç–æ–¥–∞) –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ (–¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏) –≥–µ—Å—Å–∏–∞–Ω–∞. 

## –ú–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –∫–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–π –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏

![](newton_parabola1.pdf){width=50% fig-align="center"}


![](newton_parabola2.pdf){width=50% fig-align="center"}


![](newton_parabola3.pdf){width=50% fig-align="center"}


![](newton_parabola4.pdf){width=50% fig-align="center"}


![](newton_parabola5.pdf){width=50% fig-align="center"}


![](newton_parabola6.pdf){width=50% fig-align="center"}

# –°–≤–æ–π—Å—Ç–≤–∞ –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞

## –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞

:::{.callout-theorem}
–ü—É—Å—Ç—å $f(x)$ ‚Äî —Å–∏–ª—å–Ω–æ –≤—ã–ø—É–∫–ª–∞—è –¥–≤–∞–∂–¥—ã –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ $\mathbb{R}^n$, –¥–ª—è –≤—Ç–æ—Ä–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π –∫–æ—Ç–æ—Ä–æ–π –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞: $\mu I_n\preceq \nabla^2 f(x) \preceq L I_n$. –ü—É—Å—Ç—å —Ç–∞–∫–∂–µ –≥–µ—Å—Å–∏–∞–Ω —Ñ—É–Ω–∫—Ü–∏–∏ $M$-–ª–∏–ø—à–∏—Ü–µ–≤. –¢–æ–≥–¥–∞ –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ —Å—Ö–æ–¥–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –∫ —Ä–µ—à–µ–Ω–∏—é —Å –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é, —Ç.–µ. –ø—Ä–∏ $\| x_0 - x^* \| < \frac{2 \mu}{3M}$:
$$
\|x_{k+1} - x^*\| \leq \frac{3 M}{2\mu} \|x_k - x^*\|^2
$$
:::

## –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –µ—Å–ª–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è –Ω–∞—Ä—É—à–∞—é—Ç—Å—è

:::{.callout-note appearance="simple"}
$$
f(x) = x^4 \qquad f'(x) = 4x^3 \qquad f''(x) = 12x^2
$$
:::

![](newton_linear.pdf)
$$
x_{k+1} = x_k - \frac{f'(x_k)}{f''(x_k)} = x_k - \frac{4x_k^3}{12x_k^2} = x_k - \frac{1}{3}x_k = \frac{2}{3}x_k,
$$

—Å—Ö–æ–¥–∏—Ç—Å—è –ª–∏–Ω–µ–π–Ω–æ –∫ $0$, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–º—É —Ä–µ—à–µ–Ω–∏—é –∑–∞–¥–∞—á–∏, —Å –ª–∏–Ω–µ–π–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é.

## –õ–æ–∫–∞–ª—å–Ω–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞ –¥–ª—è –≥–ª–∞–¥–∫–æ–π —Å–∏–ª—å–Ω–æ –≤—ã–ø—É–∫–ª–æ–π $f(x)$

:::: {.columns}

::: {.column width="60%"}
![](newton_piecewise_parabola.pdf)
:::

::: {.column width="40%"}
$$
f(x) = \begin{cases}
(x - 1)^2, & x \leq -1 \\
2x^2 + 2, & -1 < x < 1 \\
(x + 1)^2, & x \geq 1
\end{cases}
$$

–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å–∏–ª—å–Ω–æ –≤—ã–ø—É–∫–ª–∞, –Ω–æ –≤—Ç–æ—Ä–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏–ø—à–∏—Ü–µ–≤–æ–π.

![](newton_piecewise_parabola_non_lipshitz_hessian.pdf)
:::


::::

## –õ–æ–∫–∞–ª—å–Ω–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞ –¥–∞–∂–µ –µ—Å–ª–∏ $\nabla^2 f$ –ª–∏–ø—à–∏—Ü–µ–≤

:::: {.columns}

::: {.column width="60%"}
![](newton_piecewise_smoooth.pdf)
:::

::: {.column width="40%"}
$$
f(x) = \begin{cases}
(x - 1)^2, & x \leq -1 \\
-\frac{1}{4}x^4 + \frac{5}{2}x^2 + \frac{7}{4}, & -1 < x < 1 \\
(x + 1)^2, & x \geq 1
\end{cases}
$$

–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Å–∏–ª—å–Ω–æ –≤—ã–ø—É–∫–ª–∞ –∏ –≤—Ç–æ—Ä–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è —è–≤–ª—è–µ—Ç—Å—è –ª–∏–ø—à–∏—Ü–µ–≤–æ–π.

![](newton_piecewise_parabola_lipshitz_hessian.pdf)
:::


::::

## –õ–æ–∫–∞–ª—å–Ω–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞. –•–æ—Ä–æ—à–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

![](newton_iteration_0.pdf){width=80% fig-align="center"}


![](newton_iteration_1.pdf){width=80% fig-align="center"}


![](newton_iteration_2.pdf){width=80% fig-align="center"}


![](newton_iteration_3.pdf){width=80% fig-align="center"}


![](newton_iteration_4.pdf){width=80% fig-align="center"}


![](newton_iteration_5.pdf){width=80% fig-align="center"}

## –õ–æ–∫–∞–ª—å–Ω–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞. –ü–ª–æ—Ö–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

![](newton_iteration_div_0.pdf){width=80% fig-align="center"}


![](newton_iteration_div_1.pdf){width=80% fig-align="center"}


![](newton_iteration_div_2.pdf){width=80% fig-align="center"}


![](newton_iteration_div_3.pdf){width=80% fig-align="center"}


![](newton_iteration_div_4.pdf){width=80% fig-align="center"}


![](newton_iteration_div_5.pdf){width=80% fig-align="center"}


## –ü—Ä–æ–±–ª–µ–º—ã –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞

![Animation [\faVideo](https://github.com/MerkulovDaniil/optim/raw/master/assets/Notebooks/Newton_convergence.mp4) ](newton_field.jpeg){width=63%}

![Animation [\faVideo](https://fmin.xyz/docs/theory/inaccurate_taylor.mp4) ](inaccurate_taylor.jpeg){width=70%}


## –ú–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –¥–ª—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –∑–∞–¥–∞—á–∏ (–ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏)

$$
\min_{x \in \mathbb{R}^n} \frac{1}{2} x^\top A x - b^\top x, \qquad A \in \mathbb{R}^{n \times n}, \quad \lambda\left(A\right) \in [\mu; L].
$$

![–¢–∞–∫ –∫–∞–∫ –∑–∞–¥–∞—á–∞ - –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è, —Ç–æ –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ —Å—Ö–æ–¥–∏—Ç—Å—è –∑–∞ –æ–¥–∏–Ω —à–∞–≥.](newton_random_1_10_60.pdf)


$$
\min_{x \in \mathbb{R}^n} \frac{1}{2} x^\top A x - b^\top x, \qquad A \in \mathbb{R}^{n \times n}, \quad \lambda\left(A\right) \in [\mu; L].
$$

![–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ —Ç–æ–∂–µ –∫—Ä–∞–π–Ω–µ –±—ã—Å—Ç—Ä–æ —Å—Ö–æ–¥–∏—Ç—Å—è, –æ–¥–Ω–∞–∫–æ, –æ—Ç–º–µ—Ç–∏–º, —á—Ç–æ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–ª–∞–≥–æ–¥–∞—Ä—è —Ç–æ–º—É, —á—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –≥–µ—Å—Å–∏–∞–Ω–∞ –Ω–µ $0$, –∞ –æ–∫–æ–ª–æ $10^{-8}$. –ï—Å–ª–∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –≤ –Ω–∞–∏–≤–Ω–æ–π —Ñ–æ—Ä–º–µ —Å –æ–±—Ä–∞—â–µ–Ω–∏–µ–º –º–∞—Ç—Ä–∏—Ü—ã, —Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è –æ—à–∏–±–∫–∞, —Ç–∞–∫ –∫–∞–∫ –º–∞—Ç—Ä–∏—Ü–∞ –≤—ã—Ä–æ–∂–¥–µ–Ω–∞. –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –≤—Å–µ —Ä–∞–≤–Ω–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥, –µ—Å–ª–∏ –¥–ª—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ä–µ—à–∞—Ç—å –ª–∏–Ω–µ–π–Ω—É—é —Å–∏—Å—Ç–µ–º—É $\nabla^2 f(x_k) d_k = -\nabla f(x_k)$ –º–µ—Ç–æ–¥–æ–º –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤.](newton_random_0_10_60.pdf)


$$
\min_{x \in \mathbb{R}^n} \frac{1}{2} x^\top A x - b^\top x, \qquad A \in \mathbb{R}^{n \times n}, \quad \lambda\left(A\right) \in [\mu; L].
$$

![–ó–¥–µ—Å—å —á–∏—Å–ª–æ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–Ω–æ—Å—Ç–∏ –≥–µ—Å—Å–∏–∞–Ω–∞ –≤ $1000$ —Ä–∞–∑ –±–æ–ª—å—à–µ, —á–µ–º –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Å–ª—É—á–∞–µ, –∏ –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ —Å—Ö–æ–¥–∏—Ç—Å—è –∑–∞ $1$ –∏—Ç–µ—Ä–∞—Ü–∏—é.](newton_random_1_1000_60.pdf)

## –ú–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –¥–ª—è –∑–∞–¥–∞—á–∏ –±–∏–Ω–∞—Ä–Ω–æ–π –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

![–ù–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Ä–∞—Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞. –°—Ä–∞–∑—É –æ—Ç–º–µ—Ç–∏–º, —á—Ç–æ –≤ –∑–∞–¥–∞—á–µ –Ω–µ—Ç —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –∏ –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Å–∏–ª—å–Ω–æ–π –≤—ã–ø—É–∫–ª–æ—Å—Ç–∏. –ê —Ç–∞–∫–∂–µ –Ω–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–π —Ç–æ–≥–æ, —á—Ç–æ –º—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–µ—Ç–æ–¥ –≤ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–∏ —Ä–µ—à–µ–Ω–∏—è.](GD 0.09Heavy Ball. Œ±=9.00e-02. Œ≤=9.50e-01NAG. Œ±=9.00e-02. Œ≤=9.50e-01Newton 1_0_time.pdf)

![–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–∏–ª—å–Ω—É—é –≤—ã–ø—É–∫–ª–æ—Å—Ç—å, –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞.](GD 1.0Heavy Ball. Œ±=1.00e+00. Œ≤=4.00e-01NAG. Œ±=1.00e+00. Œ≤=4.00e-01Newton 1_0.2_time.pdf)


![–£–≤–µ–ª–∏—á–∏–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤ 50 —Ä–∞–∑ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º —Ä–∞—Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–≤—è–∑–∞—Ç—å —Å —Ç–µ–º, —á—Ç–æ –º—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–µ—Ç–æ–¥ –≤ —Ç–æ—á–∫–µ, –¥–∞–ª–µ–∫–æ–π –æ—Ç —Ä–µ—à–µ–Ω–∏—è](GD 0.08Heavy Ball. Œ±=1.50e-01. Œ≤=5.00e-01NAG. Œ±=8.00e-02. Œ≤=5.00e-01Newton 1_0.2_time_random.pdf)


![–ù–µ –º–µ–Ω—è—è –∑–∞–¥–∞—á—É, –∏–∑–º–µ–Ω–∏–º –Ω–∞—á–∞–ª—å–Ω—É—é —Ç–æ—á–∫—É –∏ –Ω–∞–±–ª—é–¥–∞–µ–º –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—É—é —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞. –û–¥–Ω–∞–∫–æ, –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã. –£–∂–µ –ø—Ä–∏ –Ω–µ–±–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏, –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –¥–æ–ª—å—à–µ, —á–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã.](GD 0.012Heavy Ball. Œ±=1.20e-02. Œ≤=5.00e-01NAG. Œ±=1.20e-02. Œ≤=5.00e-01Newton 1_0.2_time_close.pdf)

## –ó–∞–¥–∞—á–∞ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞ –º–Ω–æ–≥–æ–≥—Ä–∞–Ω–Ω–∏–∫–∞

:::: {.columns}

::: {.column width="50%"}

–ù–∞–π—Ç–∏ —Ç–æ—á–∫—É $x \in \mathbb{R}^n$, –∫–æ—Ç–æ—Ä–∞—è –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ—Ç —Å—É–º–º—É –ª–æ–≥–∞—Ä–∏—Ñ–º–æ–≤ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –¥–æ –≥—Ä–∞–Ω–∏—Ü –º–Ω–æ–≥–æ–≥—Ä–∞–Ω–Ω–∏–∫–∞:
$$
\max_{x} \sum_{i=1}^{m} \log(1 - a_i^T x) + \sum_{j=1}^{n} \log(1 - x_j^2)
$$
–∏–ª–∏, —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ, –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç:
$$
\min_{x} -\sum_{i=1}^{m} \log(1 - a_i^T x) - \sum_{j=1}^{n} \log(1 - x_j^2)
$$

–ø—Ä–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö:
- $a_i^T x < 1$ –¥–ª—è –≤—Å–µ—Ö $i = 1,...,m$, –≥–¥–µ $a_i$ - —Å—Ç—Ä–æ–∫–∏ –º–∞—Ç—Ä–∏—Ü—ã $A^T$
- $|x_j| < 1$ –¥–ª—è –≤—Å–µ—Ö $j = 1,...,n$

–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä –º–Ω–æ–≥–æ–≥—Ä–∞–Ω–Ω–∏–∫–∞ - —ç—Ç–æ —Ç–æ—á–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É–¥–∞–ª–µ–Ω–∞ –æ—Ç –≤—Å–µ—Ö –≥—Ä–∞–Ω–∏—Ü –º–Ω–æ–≥–æ–≥—Ä–∞–Ω–Ω–∏–∫–∞ –≤ —Å–º—ã—Å–ª–µ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–≥–æ –±–∞—Ä—å–µ—Ä–∞. –≠—Ç–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –º–µ—Ç–æ–¥–∞—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ç–æ—á–∫–∏ –¥–ª—è –≤—ã–ø—É–∫–ª–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.
:::

::: {.column width="50%"}
![](anal_center.pdf)
:::

::::


![](GD, Œ±=0.005Heavy Ball, Œ±=0.005, Œ≤=0.33NAG, Œ±=0.005, Œ≤=0.33Newton, damping=1.0anal_center_20_100.pdf)

![](GD, Œ±=0.00015Heavy Ball, Œ±=0.00015, Œ≤=0.79NAG, Œ±=0.00015, Œ≤=0.79Newton, damping=1.0anal_center_200_1000.pdf)


## –ê—Ñ—Ñ–∏–Ω–Ω–∞—è –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞

–í–∞–∂–Ω—ã–º —Å–≤–æ–π—Å—Ç–≤–æ–º –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞ —è–≤–ª—è–µ—Ç—Å—è **–∞—Ñ—Ñ–∏–Ω–Ω–∞—è –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å**. –ü—É—Å—Ç—å –¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è $f$ –∏ –Ω–µ–≤—ã—Ä–æ–∂–¥–µ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ $A \in \mathbb{R}^{n \times n}$, –ø—É—Å—Ç—å $x = Ay$, –∏ –ø—É—Å—Ç—å $g(y) = f(Ay)$. –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ $\nabla g(y) = A^T \nabla f(x)$ –∏ $\nabla^2 g(y) = A^T \nabla^2 f(x) A$. –®–∞–≥–∏ –ù—å—é—Ç–æ–Ω–∞ –Ω–∞ $g$ –≤—ã—Ä–∞–∂–∞—é—Ç—Å—è –∫–∞–∫:
$$
y_{k+1} = y_k - \left(\nabla^2 g(y_k)\right)^{-1} \nabla g(y_k)
$$


–†–∞—Å–∫—Ä—ã–≤–∞—è —ç—Ç–æ, –º—ã –ø–æ–ª—É—á–∞–µ–º:
$$
y_{k+1} = y_k - \left(A^T \nabla^2 f(Ay_k) A\right)^{-1} A^T \nabla f(Ay_k)
$$


–ò—Å–ø–æ–ª—å–∑—É—è —Å–≤–æ–π—Å—Ç–≤–æ –æ–±—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã $(AB)^{-1} = B^{-1} A^{-1}$, —ç—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç—Å—è –¥–æ:
$$
\begin{aligned}
y_{k+1} = y_k - A^{-1} \left(\nabla^2 f(Ay_k)\right)^{-1} \nabla f(Ay_k) \\
Ay_{k+1} = Ay_k - \left(\nabla^2 f(Ay_k)\right)^{-1} \nabla f(Ay_k) 
\end{aligned}
$$


–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø—Ä–∞–≤–∏–ª–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è $x$ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
$$
x_{k+1} = x_k - \left(\nabla^2 f(x_k)\right)^{-1} \nabla f(x_k)
$$


–≠—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∏—Ç–µ—Ä–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞, –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–∞—Å—à—Ç–∞–±–∞ –∑–∞–¥–∞—á–∏. –£ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ —Ç–∞–∫–æ–≥–æ —Å–≤–æ–π—Å—Ç–≤–∞ –Ω–µ—Ç!

## –†–µ–∑—é–º–µ

–ü–ª—é—Å—ã:

* –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤–±–ª–∏–∑–∏ —Ä–µ—à–µ–Ω–∏—è $x^*$
* –ê—Ñ—Ñ–∏–Ω–Ω–∞—è –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç—å
* –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É –º–µ—Ç–æ–¥–∞
* –°—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ–π, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–º–ø—Ñ–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ (–¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—É –ª–∏–Ω–µ–π–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ —à–∞–≥–∞ –º–µ—Ç–æ–¥–∞)


–ú–∏–Ω—É—Å—ã:

* –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ö—Ä–∞–Ω–∏—Ç—å (–æ–±—Ä–∞—Ç–Ω—ã–π) –≥–µ—Å—Å–∏–∞–Ω –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏: $\mathcal{O}(n^2)$ –ø–∞–º—è—Ç–∏
* –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ—à–∞—Ç—å –ª–∏–Ω–µ–π–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã: $\mathcal{O}(n^3)$ –æ–ø–µ—Ä–∞—Ü–∏–π
* –ì–µ—Å—Å–∏–∞–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã—Ä–æ–∂–¥–µ–Ω–Ω—ã–º –≤ $x^*$
* –ì–µ—Å—Å–∏–∞–Ω –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º $\to$ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ $-(f''(x))^{-1}f'(x)$ –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Å–ø—É—Å–∫–∞


# –ö–≤–∞–∑–∏–Ω—å—é—Ç–æ–Ω–æ–≤—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã

## –ò–Ω—Ç—É–∏—Ü–∏—è –∫–≤–∞–∑–∏–Ω—å—é—Ç–æ–Ω–æ–≤—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤

–î–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∑–∞–¥–∞—á–∏ –±–µ–∑—É—Å–ª–æ–≤–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ $f(x) \to \min\limits_{x \in \mathbb{R}^n}$ –æ–±—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –∏—Ç–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫: 
$$
x_{k+1} = x_k + \alpha_k d_k
$$
–í –º–µ—Ç–æ–¥–µ –ù—å—é—Ç–æ–Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ $d_k$ (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ù—å—é—Ç–æ–Ω–∞) —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ–º –ª–∏–Ω–µ–π–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ:
$$
B_k d_k = - \nabla f(x_k), \;\;\; B_k = \nabla^2 f(x_k)
$$
—Ç.–µ. –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ **–≤—ã—á–∏—Å–ª–∏—Ç—å** –≥–µ—Å—Å–∏–∞–Ω –∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç –∏ **—Ä–µ—à–∏—Ç—å** –ª–∏–Ω–µ–π–Ω—É—é —Å–∏—Å—Ç–µ–º—É.
–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –µ—Å–ª–∏ –º—ã –≤–æ–∑—å–º–µ–º –µ–¥–∏–Ω–∏—á–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É $B_k = I_n$ –≤ –∫–∞—á–µ—Å—Ç–≤–µ $B_k$ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ, –º—ã –ø–æ–ª—É—á–∏–º —Ç–æ—á–Ω–æ –º–µ—Ç–æ–¥ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞.

–û–±—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –∫–≤–∞–∑–∏–Ω—å—é—Ç–æ–Ω–æ–≤—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –≤—ã–±–æ—Ä–µ –º–∞—Ç—Ä–∏—Ü—ã $B_k$ —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∞ –≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º —Å–º—ã—Å–ª–µ —Å—Ç—Ä–µ–º–∏–ª–∞—Å—å –∫ –∏—Å—Ç–∏–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –≥–µ—Å—Å–∏–∞–Ω–∞ $\nabla^2 f(x_k)$ –ø—Ä–∏ $k \to \infty$. –ö–æ–Ω–µ—á–Ω–æ, –≤–∞–∂–Ω–æ –ø—Ä–∏ —ç—Ç–æ–º —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –±—ã–ª–∏ –Ω–µ —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–∏–º–∏.

## –°—Ö–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–≤–∞–∑–∏–Ω—å—é—Ç–æ–Ω–æ–≤—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤

–ü—É—Å—Ç—å $x_{0} \in \mathbb{R}^n$, $B_{0} \succ 0$. –î–ª—è $k = 1, 2, 3, \dots$, –ø–æ–≤—Ç–æ—Ä—è–µ–º: 

1. –†–µ—à–∏—Ç—å $B_{k} d_{k} = -\nabla f(x_{k})$
2. –û–±–Ω–æ–≤–∏—Ç—å $x_{k+1} = x_{k} + \alpha_k d_{k}$
3. –í—ã—á–∏—Å–ª–∏—Ç—å $B_{k+1}$ –∏–∑ $B_{k}$

–†–∞–∑–Ω—ã–µ –∫–≤–∞–∑–∏–Ω—å—é—Ç–æ–Ω–æ–≤—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã —Ä–µ–∞–ª–∏–∑—É—é—Ç —à–∞–≥ 3 –ø–æ-—Ä–∞–∑–Ω–æ–º—É. –ú—ã —Å–∫–æ—Ä–æ —É–≤–∏–¥–∏–º, —á—Ç–æ —á–∞—Å—Ç–æ –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å $(B_{k+1})^{-1}$ –∏–∑ $(B_{k})^{-1}$.


**–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è:** –ü–æ—Å–∫–æ–ª—å–∫—É $B_{k}$ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥–µ—Å—Å–∏–∞–Ω–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–¥—Ö–æ–¥—è—â–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è $B_{k+1}$.


**–†–∞–∑—É–º–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –¥–ª—è $B_{k+1}$** (–≤–¥–æ—Ö–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –º–µ—Ç–æ–¥–æ–º —Å–µ–∫—É—â–∏—Ö): 
$$
\begin{aligned}
\nabla f(x_{k+1}) - \nabla f(x_{k}) &= B_{k+1} (x_{k+1} - x_k) =  B_{k+1} d_{k} \\
\Delta y_k &= B_{k+1} \Delta x_k
\end{aligned}
$$

–ü–æ–º–∏–º–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Å–µ–∫—É—â–µ–π, –º—ã —Ö–æ—Ç–∏–º –Ω–∞–ª–æ–∂–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ $B_{k+1}$: 

* $B_{k+1}$ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π
* $B_{k+1}$ –±–ª–∏–∑–∫–∞ –∫ $B_k$
* $B_k \succ 0 \Rightarrow B_{k+1} \succ 0$

## C–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ –æ–¥–Ω–æ—Ä–∞–Ω–≥–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–ü–æ–ø—Ä–æ–±—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∞:
$$
B_{k+1} = B_k + a u u^T
$$
–£—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–µ–∫—É—â–µ–π $B_{k+1} d_k = \Delta y_k$ –¥–∞–µ—Ç:
$$
(a u^T d_k) u = \Delta y_k - B_k d_k
$$
–≠—Ç–æ –≤–µ—Ä–Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ $u$ –∫—Ä–∞—Ç–Ω–æ $\Delta y_k - B_k d_k$. –ü–æ–ª–æ–∂–∏–≤ $u = \Delta y_k - B_k d_k$, –º—ã —Ä–µ—à–∞–µ–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ, 
$$
a = \frac{1}{(\Delta y_k - B_k d_k)^T d_k},
$$ 
—á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ 
$$
B_{k+1} = B_k +  \frac{(\Delta y_k - B_k d_k)(\Delta y_k - B_k d_k)^T}{(\Delta y_k - B_k d_k)^T d_k}
$$

–≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–º –æ–¥–Ω–æ—Ä–∞–Ω–≥–æ–≤—ã–º (SR1) –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∏–ª–∏ –º–µ—Ç–æ–¥–æ–º –ë—Ä–æ–π–¥–µ–Ω–∞.

## –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ –æ–¥–Ω–æ—Ä–∞–Ω–≥–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã

–ö–∞–∫ –º—ã –º–æ–∂–µ–º —Ä–µ—à–∏—Ç—å 
$$
B_{k+1} d_{k+1} = -\nabla f(x_{k+1}),
$$ 
—á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥? 
–ü–æ–º–∏–º–æ –≤—ã–≤–æ–¥–∞ $B_{k+1}$ –∏–∑ $B_k$, –¥–∞–≤–∞–π—Ç–µ –ø–æ–ª—É—á–∏–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞ –æ–±—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã, —Ç.–µ. $C_{k+1} = (B_{k+1})^{-1}$ –∏–∑ $C_k = B_k^{-1}$.

### –§–æ—Ä–º—É–ª–∞ –®–µ—Ä–º–∞–Ω–∞-–ú–æ—Ä—Ä–∏—Å–æ–Ω–∞:
–§–æ—Ä–º—É–ª–∞ –®–µ—Ä–º–∞–Ω–∞-–ú–æ—Ä—Ä–∏—Å–æ–Ω–∞ —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç:

$$
(A + uv^T)^{-1} = A^{-1} - \frac{A^{-1}uv^T A^{-1}}{1 + v^T A^{-1}u}
$$

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–ª—è SR1 –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –æ–±—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Ç–∞–∫–∂–µ –ª–µ–≥–∫–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:
$$
C_{k+1} = C_k + \frac{(d_k - C_k \Delta y_k)(d_k - C_k \Delta y_k)^T}{(d_k - C_k \Delta y_k)^T \Delta y_k}
$$
SR1 –ø—Ä–æ—Å—Ç –∏ –¥–µ—à–µ–≤, –Ω–æ —É –Ω–µ–≥–æ –µ—Å—Ç—å –∫–ª—é—á–µ–≤–æ–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫: –æ–Ω –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—É—é –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å.

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –î–∞–≤–∏–¥–æ–Ω–∞-–§–ª–µ—Ç—á–µ—Ä–∞-–ü–∞—É—ç–ª–ª–∞

–ú—ã –º–æ–≥–ª–∏ –±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ç—É –∂–µ –∏–¥–µ—é –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã $C$: 
$$
C_{k+1} = C_k + a u u^T + b v v^T.
$$

–£–º–Ω–æ–∂–∞—è –Ω–∞ $\Delta y_k$, –∏—Å–ø–æ–ª—å–∑—É—è —É—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–µ–∫—É—â–µ–π $d_k = C_k \Delta y_k$ –∏ —Ä–µ—à–∞—è –¥–ª—è $a$, $b$, –ø–æ–ª—É—á–∞–µ–º:
$$
C_{k+1} = C_k - \frac{C_k \Delta y_k \Delta y_k^T C_k}{\Delta y_k^T C_k \Delta y_k} + \frac{d_k d_k^T}{\Delta y_k^T d_k}
$$

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª—ã –í—É–¥–±–µ—Ä–∏
–§–æ—Ä–º—É–ª–∞ –í—É–¥–±–µ—Ä–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã:

$$
B_{k+1} = \left(I - \frac{\Delta y_k d_k^T}{\Delta y_k^T d_k}\right)B_k\left(I - \frac{d_k \Delta y_k^T}{\Delta y_k^T d_k}\right) + \frac{\Delta y_k \Delta y_k^T}{\Delta y_k^T d_k}
$$
–≠—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –î–∞–≤–∏–¥–æ–Ω–∞-–§–ª–µ—Ç—á–µ—Ä–∞-–ü–∞—É—ç–ª–ª–∞ (DFP). –¢–∞–∫–∂–µ –¥–µ—à–µ–≤–æ: $O(n^2)$, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—É—é –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å. –ù–µ —Ç–∞–∫ –ø–æ–ø—É–ª—è—Ä–Ω–æ, –∫–∞–∫ BFGS.

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë—Ä–æ–π–¥–µ–Ω–∞ ‚Äî –§–ª–µ—Ç—á–µ—Ä–∞ ‚Äî –ì–æ–ª—å–¥—Ñ–∞—Ä–±–∞ ‚Äî –®–∞–Ω–Ω–æ

–ü–æ–ø—Ä–æ–±—É–µ–º —Ç–µ–ø–µ—Ä—å –¥–≤—É—Ö—Ä–∞–Ω–≥–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:
$$
B_{k+1} = B_k + a u u^T + b v v^T.
$$
–£—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–µ–∫—É—â–µ–π $\Delta y_k = B_{k+1} d_k$ –¥–∞–µ—Ç:
$$
\Delta y_k - B_k d_k = (a u^T d_k) u + (b v^T d_k) v
$$
–ü–æ–ª–æ–∂–∏–≤ $u = \Delta y_k$, $v = B_k d_k$ –∏ —Ä–µ—à–∞—è –¥–ª—è $a$, $b$, –ø–æ–ª—É—á–∞–µ–º:
$$
B_{k+1} = B_k - \frac{B_k d_k d_k^T B_k}{d_k^T B_k d_k} + \frac{\Delta y_k \Delta y_k^T}{d_k^T \Delta y_k}
$$
–≠—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë—Ä–æ–π–¥–µ–Ω–∞ ‚Äî –§–ª–µ—Ç—á–µ—Ä–∞ ‚Äî –ì–æ–ª—å–¥—Ñ–∞—Ä–±–∞ ‚Äî –®–∞–Ω–Ω–æ (BFGS).

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë—Ä–æ–π–¥–µ–Ω–∞ ‚Äî –§–ª–µ—Ç—á–µ—Ä–∞ ‚Äî –ì–æ–ª—å–¥—Ñ–∞—Ä–±–∞ ‚Äî –®–∞–Ω–Ω–æ —Å –∏–Ω–≤–µ—Ä—Å–∏–µ–π

### –§–æ—Ä–º—É–ª–∞ –í—É–¥–±–µ—Ä–∏

–§–æ—Ä–º—É–ª–∞ –í—É–¥–±–µ—Ä–∏, –æ–±–æ–±—â–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª—ã –®–µ—Ä–º–∞–Ω–∞-–ú–æ—Ä—Ä–∏—Å–æ–Ω–∞, –¥–∞–µ—Ç—Å—è –∫–∞–∫:
$$
(A + UCV)^{-1} = A^{-1} - A^{-1}U(C^{-1} + V A^{-1}U)^{-1}V A^{-1}
$$
–ü—Ä–∏–º–µ–Ω–µ–Ω–Ω–∞—è –∫ –Ω–∞—à–µ–º—É —Å–ª—É—á–∞—é, –º—ã –ø–æ–ª—É—á–∞–µ–º –¥–≤—É—Ö—Ä–∞–Ω–≥–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ–±—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ $C$:
$$
C_{k+1} = C_k + \frac{(d_k - C_k \Delta y_k) d_k^T}{\Delta y_k^T d_k} + \frac{d_k (d_k - C_k \Delta y_k)^T}{\Delta y_k^T d_k} - \frac{(d_k - C_k \Delta y_k)^T \Delta y_k}{(\Delta y_k^T d_k)^2} d_k d_k^T
$$

$$
C_{k+1} = \left(I - \frac{d_k \Delta y_k^T}{\Delta y_k^T d_k}\right) C_k \left(I - \frac{\Delta y_k d_k^T}{\Delta y_k^T d_k}\right) + \frac{d_k d_k^T}{\Delta y_k^T d_k}
$$

–≠—Ç–∞ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç, —á—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ BFGS, –æ—Å—Ç–∞–≤–∞—è—Å—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–±—â–∏–º, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ —Ç—Ä–µ–±—É–µ—Ç $O(n^2)$ –æ–ø–µ—Ä–∞—Ü–∏–π. –í–∞–∂–Ω–æ, —á—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ BFGS —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—É—é –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å: $B_k \succ 0 \Rightarrow B_{k+1} \succ 0.$ –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ, $C_k \succ 0 \Rightarrow C_{k+1} \succ 0$

## –ö–æ–¥

* [–û—Ç–∫—Ä—ã—Ç—å –≤ Colab](https://colab.research.google.com/github/MerkulovDaniil/optim/blob/master/assets/Notebooks/Quasi_Newton.ipynb)
* [–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–≤–∞–∑–∏–Ω—å—é—Ç–æ–Ω–æ–≤—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤](https://nbviewer.jupyter.org/github/fabianp/pytron/blob/master/doc/benchmark_logistic.ipynb)
* [–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è –æ –º–µ—Ç–æ–¥–µ –ù—å—é—Ç–æ–Ω–∞](https://colab.research.google.com/github/MerkulovDaniil/optim/blob/master/assets/Notebooks/Newton.ipynb)

# –ë–æ–Ω—É—Å: –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞

## –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞

:::{.callout-theorem}
–ü—É—Å—Ç—å $f(x)$ ‚Äî —Å–∏–ª—å–Ω–æ –≤—ã–ø—É–∫–ª–∞—è –¥–≤–∞–∂–¥—ã –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ $\mathbb{R}^n$, –¥–ª—è –≤—Ç–æ—Ä–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π –∫–æ—Ç–æ—Ä–æ–π –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞: $\mu I_n\preceq \nabla^2 f(x) \preceq L I_n$. –ü—É—Å—Ç—å —Ç–∞–∫–∂–µ –≥–µ—Å—Å–∏–∞–Ω —Ñ—É–Ω–∫—Ü–∏–∏ $M$-–ª–∏–ø—à–∏—Ü–µ–≤. –¢–æ–≥–¥–∞ –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ —Å—Ö–æ–¥–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –∫ —Ä–µ—à–µ–Ω–∏—é —Å –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é, —Ç.–µ. –ø—Ä–∏ $\| x_0 - x^* \| < \frac{2 \mu}{3M}$:
$$
\|x_{k+1} - x^*\| \leq \frac{3 M}{2\mu} \|x_k - x^*\|^2
$$
:::


**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ**

1. –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É–ª—É –ù—å—é—Ç–æ–Ω–∞-–õ–µ–π–±–Ω–∏—Ü–∞ 
    $$
    \nabla f(x_{k}) - \nabla f(x^*) = \int_0^1 \nabla^2 f(x^* + \tau (x_k - x^*))  (x_k - x^*) d\tau
    $$

2. –ú—ã –±—É–¥–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ä–µ—à–µ–Ω–∏—è
    $$
    \begin{aligned} 
     x_{k+1} - x^* = x_k -\left[ \nabla^2 f(x_k)\right]^{-1} \nabla f(x_{k}) - x^* = x_k - x^* -\left[ \nabla^2 f(x_k)\right]^{-1} \nabla f(x_{k}) = \\ 
     = x_k - x^* - \left[ \nabla^2 f(x_k)\right]^{-1}  \int_0^1 \nabla^2 f(x^* + \tau (x_k - x^*))  (x_k - x^*) d\tau 
    \end{aligned} 
    $$

## –°—Ö–æ–¥–∏–º–æ—Å—Ç—å

3. 
    $$
    \begin{aligned}
    = \left( I - \left[ \nabla^2 f(x_k)\right]^{-1} \int_0^1 \nabla^2 f(x^* + \tau (x_k - x^*)) d \tau\right) (x_k - x^*)= \\
    = \left[ \nabla^2 f(x_k)\right]^{-1} \left( \nabla^2 f(x_k) - \int_0^1 \nabla^2 f(x^* + \tau (x_k - x^*)) d \tau\right) (x_k - x^*) = \\ 
    = \left[ \nabla^2 f(x_k)\right]^{-1} \left( \int_0^1 \left( \nabla^2 f(x_k) - \nabla^2 f(x^* + \tau (x_k - x^*)) d \tau\right)\right) (x_k - x^*)= \\ 
    = \left[ \nabla^2 f(x_k)\right]^{-1} G_k (x_k - x^*) 
    \end{aligned}
    $$ 

4. –í–≤–µ–¥—ë–º:
    $$
    G_k = \int_0^1 \left( \nabla^2 f(x_k) - \nabla^2 f(x^* + \tau (x_k - x^*)) d \tau\right).
    $$

## –°—Ö–æ–¥–∏–º–æ—Å—Ç—å

5. –ü–æ–ø—Ä–æ–±—É–µ–º –æ—Ü–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä $G_k$ —Å –ø–æ–º–æ—â—å—é $r_k = \| x_k - x^* \|$:
    $$
    \begin{aligned} 
     \| G_k\| = \left\| \int_0^1 \left( \nabla^2 f(x_k) - \nabla^2 f(x^* + \tau (x_k - x^*)) d \tau\right)\right\| \leq \\ 
    \leq \int_0^1 \left\| \nabla^2 f(x_k) - \nabla^2 f(x^* + \tau (x_k - x^*))   \right\|d\tau \leq \qquad \text{(–õ–∏–ø—à–∏—Ü–µ–≤–æ—Å—Ç—å –≥–µ—Å—Å–∏–∞–Ω–∞)}\\ 
    \leq \int_0^1 M\|x_k - x^* - \tau (x_k - x^*)\| d \tau = \int_0^1 M\|x_k - x^*\|(1- \tau)d \tau = \frac{r_k}{2}M, 
    \end{aligned} 
    $$ 

6. –ü–æ–ª—É—á–∞–µ–º: 
    $$ 
    r_{k+1}  \leq \left\|\left[ \nabla^2 f(x_k)\right]^{-1}\right\| \cdot \frac{r_k}{2}M \cdot r_k 
    $$
    –∏ –Ω–∞–º –Ω—É–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –Ω–æ—Ä–º—É –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≥–µ—Å—Å–∏–∞–Ω–∞

## –°—Ö–æ–¥–∏–º–æ—Å—Ç—å

:::: {.columns}

::: {.column width="40%"}
7. –ò–∑ –ª–∏–ø—à–∏—Ü–µ–≤–æ—Å—Ç–∏ –∏ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ—Å—Ç–∏ –≥–µ—Å—Å–∏–∞–Ω–∞: 
    $$
    \begin{aligned} 
    \nabla^2 f(x_k) - \nabla^2 f(x^*) \succeq - Mr_k I_n \\ 
    \nabla^2 f(x_k) \succeq \nabla^2 f(x^*) - Mr_k I_n \\ 
    \nabla^2 f(x_k) \succeq \mu I_n - Mr_k I_n \\ 
    \nabla^2 f(x_k) \succeq (\mu- Mr_k )I_n \\ 
    \end{aligned} 
    $$
8. –ò–∑ —Å–∏–ª—å–Ω–æ–π –≤—ã–ø—É–∫–ª–æ—Å—Ç–∏ —Å–ª–µ–¥—É–µ—Ç, —á—Ç–æ $\nabla^2 f(x_k) \succ 0$, —Ç.–µ. $r_k < \frac{\mu}{M}$. 
    $$
    \begin{aligned} 
    \left\|\left[ \nabla^2 f(x_k)\right]^{-1}\right\| \leq (\mu - Mr_k)^{-1} \\
    r_{k+1}  \leq \dfrac{r_k^2 M}{2(\mu - Mr_k)} 
    \end{aligned} 
    $$
:::

::: {.column width="60%"}
9. –ü–æ—Ç—Ä–µ–±—É–µ–º, —á—Ç–æ–±—ã –≤–µ—Ä—Ö–Ω—è—è –æ—Ü–µ–Ω–∫–∞ –Ω–∞ $r_{k+1}$ –±—ã–ª–∞ –º–µ–Ω—å—à–µ $r_k$, —É—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ $0 <r_k < \frac{\mu}{M}$:
    $$
    \begin{aligned}
    \dfrac{r_k^2 M}{2(\mu - Mr_k)} &< r_k \\
    \frac{M}{2(\mu - Mr_k)}\, r_k &< 1 \\
    M r_k &< 2(\mu - Mr_k) \\
    3 M r_k &< 2\mu \\
    r_k &< \frac{2\mu}{3M}
    \end{aligned} 
    $$

10. –í–æ–∑–≤—Ä–∞—â–∞—è—Å—å –∫ –æ—Ü–µ–Ω–∫–µ –Ω–µ–≤—è–∑–∫–∏ –Ω–∞ $k+1$-–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏, –ø–æ–ª—É—á–∞–µ–º:
    $$
    r_{k+1}  \leq \dfrac{r_k^2 M}{2(\mu - Mr_k)} < \dfrac{3 M r_k^2 }{2\mu}
    $$

    –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –ø–æ–ª—É—á–∏–ª–∏ –≤–∞–∂–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ª–∏–ø—à–∏—Ü–µ–≤—ã–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º –≥–µ—Å—Å–∏–∞–Ω–æ–º —Å—Ö–æ–¥–∏—Ç—Å—è **–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ** –≤–±–ª–∏–∑–∏ —Ä–µ—à–µ–Ω–∏—è.
:::
::::


## –ë–æ–Ω—É—Å: –ò–¥–µ—è –º–µ—Ç–æ–¥–æ–≤ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π –º–µ—Ç—Ä–∏–∫–∏

:::: {.columns}

::: {.column width="50%"}
–ü—É—Å—Ç—å –¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è $f(x)$ –∏ —Ç–æ—á–∫–∞ $x_0$. –û–ø—Ä–µ–¥–µ–ª–∏–º $B_\varepsilon(x_0) = \{x \in \mathbb{R}^n : d(x, x_0) = \varepsilon^2 \}$ –∫–∞–∫ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º $\varepsilon$ –¥–æ $x_0$. –ó–¥–µ—Å—å –º—ã –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è $d(x, x_0)$.
$$
x^* = \text{arg}\min_{x \in B_\varepsilon(x_0)} f(x)
$$
–î–∞–ª–µ–µ, –º—ã –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥—Ä—É–≥–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ *–Ω–∞–∏—Å–∫–æ—Ä–µ–π—à–µ–≥–æ —Å–ø—É—Å–∫–∞* –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –º–∏–Ω–∏–º–∏–∑–∞—Ç–æ—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ —Å—Ñ–µ—Ä–µ:
$$
s = \lim_{\varepsilon \to 0} \frac{x^* - x_0}{\varepsilon}
$$
–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–π –º–µ—Ç—Ä–∏–∫–æ–π $A$:
$$
d(x, x_0) = (x-x_0)^\top A (x-x_0)
$$
–î–∞–ª–µ–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–µ—Ä–≤—ã–π –ø–æ—Ä—è–¥–æ–∫ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ $f(x)$ –≤ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–∏ —Ç–æ—á–∫–∏ $x_0$:
$$
f(x_0 + \delta x) \approx f(x_0) + \nabla f(x_0)^\top \delta x
$$ {#eq-taylor}
:::

::: {.column width="50%"}
–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è $s$, –∫–∞–∫ —ç—Ç–æ –±—ã–ª–æ —Å–∫–∞–∑–∞–Ω–æ –≤—ã—à–µ.
$$
\begin{aligned}
&\min_{\delta x \in \mathbb{R^n}} f(x_0 + \delta x) \\
\text{s.t.}\;& \delta x^\top A \delta x = \varepsilon^2
\end{aligned}
$$
–ò—Å–ø–æ–ª—å–∑—É—è [—É—Ä–∞–≤–Ω–µ–Ω–∏–µ @eq-taylor], –ø–æ–ª—É—á–∞–µ–º:
$$
\begin{aligned}
&\min_{\delta x \in \mathbb{R^n}} \nabla f(x_0)^\top \delta x \\
\text{s.t.}\;& \delta x^\top A \delta x = \varepsilon^2
\end{aligned}
$$
–ò—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ –º–Ω–æ–∂–∏—Ç–µ–ª–µ–π –õ–∞–≥—Ä–∞–Ω–∂–∞:
$$
\delta x = - \frac{2 \varepsilon^2}{\nabla f (x_0)^\top A^{-1} \nabla f (x_0)} A^{-1} \nabla f
$$
–ù–æ–≤–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–∏—Å–∫–æ—Ä–µ–π—à–µ–≥–æ —Å–ø—É—Å–∫–∞ : $-A^{-1} \nabla f(x_0)$.
–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–∑–æ—Ç—Ä–æ–ø–Ω–æ –∏ $A = I$, –º—ã —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∞–µ–º —Ñ–æ—Ä–º—É–ª—É –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –≥–µ—Å—Å–∏–∞–Ω –∫–∞–∫ –º–∞—Ç—Ä–∏—Ü—É –º–µ—Ç—Ä–∏–∫.
:::

::::

\newpage 
<!--
# –ó–∞–¥–∞—á–∏ –Ω–∞ –¥–æ–º

1. **üò± –°—Ö–æ–¥–∏–º–æ—Å—Ç—å –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞** (7 –±–∞–ª–ª–æ–≤) 

    –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–ª–µ–¥—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é: 

    $$
    f(x,y) = \dfrac{x^4}{4} - x^2 + 2x + (y-1)^2
    $$
    –∏ –≤–æ–∑—å–º–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é —Ç–æ—á–∫—É $x_0 = (0,2)^\top$. –ö–∞–∫ –≤–µ–¥–µ—Ç —Å–µ–±—è –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∏–∑ —ç—Ç–æ–π —Ç–æ—á–∫–∏? –ö–∞–∫ —ç—Ç–æ –æ–±—ä—è—Å–Ω–∏—Ç—å? –ö–∞–∫ –≤–µ–¥–µ—Ç —Å–µ–±—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —à–∞–≥–æ–º $\alpha = 0.01$ –∏ –º–µ—Ç–æ–¥ –Ω–∞–∏—Å–∫–æ—Ä–µ–π—à–µ–≥–æ —Å–ø—É—Å–∫–∞ –ø—Ä–∏ —Ç–µ—Ö –∂–µ —É—Å–ª–æ–≤–∏—è—Ö? (–ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —á–∏—Å–ª–µ–Ω–Ω—ã–µ —Å–∏–º—É–ª—è—Ü–∏–∏ –≤ —ç—Ç–æ–π –∑–∞–¥–∞—á–µ).

1. **–ú–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –±–µ–∑ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≥–µ—Å—Å–∏–∞–Ω–∞** (16 –±–∞–ª–ª–æ–≤) –í —ç—Ç–æ–π –∑–∞–¥–∞—á–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∑–∞–¥–∞—á–∏ –±–∏–Ω–∞—Ä–Ω–æ–π –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤. –ù–µ –±–µ—Å–ø–æ–∫–æ–π—Ç–µ—Å—å –æ —Ä–∞–∑–º–µ—Ä–µ –æ–ø–∏—Å–∞–Ω–∏—è –∑–∞–¥–∞—á–∏, –ø–µ—Ä–≤—ã–µ 5 –ø—É–Ω–∫—Ç–æ–≤ –∏–∑ 7 –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–æ–≤–æ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ. –í —ç—Ç–æ–π –∑–∞–¥–∞—á–µ –≤—ã –¥–æ–ª–∂–Ω—ã –Ω–∞—á–∞—Ç—å —Å —ç—Ç–æ–≥–æ [\faPython colab notebook](https://colab.research.google.com/github/MerkulovDaniil/optim/blob/master/assets/Notebooks/Hessian_free_Newton.ipynb)

    –î–∞–Ω–∞ –≤—ã–±–æ—Ä–∫–∞ —Å $n$ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è–º–∏, –≥–¥–µ –∫–∞–∂–¥–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –≤–µ–∫—Ç–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ $x_i$ –∏ —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å –Ω–∏–º –±–∏–Ω–∞—Ä–Ω–æ–π —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π $y_i \in \{0,1\}$. –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ $y_i = 1$ –ø—Ä–∏ –¥–∞–Ω–Ω–æ–º $x_i$ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å, –∫–æ—Ç–æ—Ä–∞—è –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è, —ç—Ç–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è –Ω–∞–±–ª—é–¥–∞–µ–º—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–¥ —ç—Ç–æ–π –º–æ–¥–µ–ª—å—é, —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ –≤—Å–µ–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è–º. –û–Ω–∞ –∏–º–µ–µ—Ç –≤—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ–≥–¥–∞ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç –¥–∞–Ω–Ω—ã—Ö $y$.

    –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –±–∏–Ω–∞—Ä–Ω–æ–π –∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è $(x_i, y_i)$ –∑–∞–¥–∞–µ—Ç—Å—è –∫–∞–∫:
    $$
    \text{Loss}(w; x_i, y_i) = -\left[ y_i \log(p(y_i=1 | x_i; w)) + (1-y_i) \log(1-p(y_i=1 | x_i; w)) \right]
    $$

    –ó–¥–µ—Å—å $p(y=1 | x;w)$ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫:
    $$
    p(y=1 | x;w) = \frac{1}{1 + e^{-w^T x}}
    $$

    –ß—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–±—â—É—é –ø–æ—Ç–µ—Ä—é –Ω–∞–¥ –Ω–∞–±–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö, –º—ã —Å—É–º–º–∏—Ä—É–µ–º –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏:
    $$
    f(w) = -\sum_{i=1}^n \left[ y_i \log(p(y_i=1 | x_i; w)) + (1-y_i) \log(1-p(y_i=1 | x_i; w)) \right]
    $$

    –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ –≤ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∑–∞–¥–∞–µ—Ç—Å—è –∫–∞–∫:
    $$
    \min_w f(w) = \min_w -\sum_{i=1}^n \left[ y_i \log\left(p\left(y_i=1 | x_i; w\right)\right) + \left(1-y_i\right) \log\left(1-p(y_i=1 | x_i; w)\right) \right]
    $$

    –≠—Ç–æ –∑–∞–¥–∞—á–∞ –≤—ã–ø—É–∫–ª–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ—à–µ–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫, –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞, –∏–ª–∏ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, —á–∞—Å—Ç–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –û–¥–Ω–∞–∫–æ, —ç—Ç–∞ –∑–∞–¥–∞—á–∞ —á–∞—Å—Ç–æ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π $l_2$:

    $$
    \min_w f(w) = \min_w -\sum_{i=1}^n \left[ y_i \log\left(p\left(y_i=1 | x_i; w\right)\right) + \left(1-y_i\right) \log\left(1-p(y_i=1 | x_i; w)\right) \right] + \frac{\mu}{2} \|w\|_2^2
    $$

    1. (1,6 –±–∞–ª–ª–æ–≤) –í–æ-–ø–µ—Ä–≤—ã—Ö, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ (Gradient Descent, GD) –≤ —Å–∏–ª—å–Ω–æ –≤—ã–ø—É–∫–ª–æ–π –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–∏ $\mu = 1$. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π —à–∞–≥ –æ–±—É—á–µ–Ω–∏—è $\alpha$. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞. –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∏–±–æ–ª—å—à–∏–π —à–∞–≥ –æ–±—É—á–µ–Ω–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Å—Ö–æ–¥–∏—Ç—Å—è. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –∫–∞–∫ –æ–±–ª–∞—Å—Ç–∏ (–∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤), —Ç–∞–∫ –∏ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ (–ø–æ—Ç–µ—Ä–∏). –û–ø–∏—à–∏—Ç–µ —Ç–∏–ø –Ω–∞–±–ª—é–¥–∞–µ–º–æ–π —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

        ```python
        params = {
            "mu": 1,
            "m": 1000,
            "n": 100,
            "methods": [
                {
                    "method": "GD",
                    "learning_rate": 3e-2,
                    "iterations": 550,
                },
            ]
        }

        results, params = run_experiments(params)
        ```
    
    2. (1,6 –±–∞–ª–ª–æ–≤) –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –ø—Ä–∏ —Ç–µ—Ö –∂–µ —É—Å–ª–æ–≤–∏—è—Ö, –∏—Å–ø–æ–ª—å–∑—É—è –≤—Ç–æ—Ä—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –¥–ª—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏. –û–ø–∏—à–∏—Ç–µ –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

        ```python
        params = {
            "mu": 1,
            "m": 1000,
            "n": 100,
            "methods": [
                {
                    "method": "GD",
                    "learning_rate": 3e-2,
                    "iterations": 550,
                },
                {
                    "method": "Newton",
                    "iterations": 20,
                },
            ]
        }

        results, params = run_experiments(params)
        ```
        
    3. (1,6 –±–∞–ª–ª–æ–≤) –í —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞ –º–æ–∂–µ—Ç —Å—Ö–æ–¥–∏—Ç—å—Å—è —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ –∏–ª–∏ ¬´–ø–µ—Ä–µ—Å–∫–∞–∫–∏–≤–∞—Ç—å¬ª —á–µ—Ä–µ–∑ –º–∏–Ω–∏–º—É–º,  –∑–∞—Ç–æ—Ä–º–æ–∂–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –º–µ—Ç–æ–¥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤–æ–π. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞—Ç–æ—Ä–º–æ–∂–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –ù—å—é—Ç–æ–Ω–∞. –û—Ç—Ä–µ–≥—É–ª–∏—Ä—É–π—Ç–µ —Ñ–∞–∫—Ç–æ—Ä –∑–∞—Ç—É—Ö–∞–Ω–∏—è –∫–∞–∫ —à–∞–≥ –æ–±—É—á–µ–Ω–∏—è. –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∏–±–æ–ª—å—à–∏–π —à–∞–≥ –æ–±—É—á–µ–Ω–∏—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

        ```python
        params = {
            "mu": 1,
            "m": 1000,
            "n": 100,
            "methods": [
                {
                    "method": "GD",
                    "learning_rate": 3e-2,
                    "iterations": 550,
                },
                {
                    "method": "Newton",
                    "iterations": 20,
                },
                {
                    "method": "Newton",
                    "learning_rate": 5e-1,
                    "iterations": 50,
                },
            ]
        }

        results, params = run_experiments(params)
        ```
    
    4. (1,6 –±–∞–ª–ª–æ–≤) –¢–µ–ø–µ—Ä—å –æ—Ç–∫–ª—é—á–∏–º —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ $\mu=0$. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–π—Ç–∏ –Ω–∞–∏–±–æ–ª—å—à–∏–π —à–∞–≥ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π —à–∞–≥ –æ–±—É—á–µ–Ω–∏—è $\alpha$. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞. –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∏–±–æ–ª—å—à–∏–π —à–∞–≥ –æ–±—É—á–µ–Ω–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Å—Ö–æ–¥–∏—Ç—Å—è. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –∫–∞–∫ –æ–±–ª–∞—Å—Ç–∏ (–∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤), —Ç–∞–∫ –∏ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ (–ø–æ—Ç–µ—Ä–∏). –û–ø–∏—à–∏—Ç–µ —Ç–∏–ø –Ω–∞–±–ª—é–¥–∞–µ–º–æ–π —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏. –ö–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –æ–ø–∏—Å–∞—Ç—å –∏–¥–µ—é –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Å—Ç—Ä–æ–≥–æ–≥–æ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ —Ä–∞–∑—Ä—ã–≤–∞ $f(x_k) - f^* \approx 10^{-2}$ –∏–ª–∏ $10^{-3}$, $10^{-4}$?

        ```python
        params = {
            "mu": 0,
            "m": 1000,
            "n": 100,
            "methods": [
                {
                    "method": "GD",
                    "learning_rate": 3e-2,
                    "iterations": 200,
                },
                {
                    "method": "GD",
                    "learning_rate": 7e-2,
                    "iterations": 200,
                },
            ]
        }

        results, params = run_experiments(params)
        ```
    
    5. (1,6 –±–∞–ª–ª–æ–≤) –ß—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å–∫–∞–∑–∞—Ç—å –æ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞ –≤ —Ç–æ–π –∂–µ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–µ $\mu=0$? –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è, –º–µ–Ω—å—à–∏—Ö –µ–¥–∏–Ω–∏—Ü—ã, –¥–ª—è –∑–∞—Ç–æ—Ä–º–æ–∂–µ–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞. –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —ç—Ç–æ? –ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–∏ –≤—ã–≤–æ–¥—ã –æ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—Ç–æ—Ä–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –¥–ª—è –∑–∞–¥–∞—á–∏ –±–∏–Ω–∞—Ä–Ω–æ–π –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.
    
    6. (4 –±–∞–ª–ª–∞) –¢–µ–ø–µ—Ä—å –≤–µ—Ä–Ω–µ–º—Å—è –∫ —Å–∏–ª—å–Ω–æ –≤—ã–ø—É–∫–ª–æ–π –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–µ $\mu=1$. –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä—è–º–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –≥–µ—Å—Å–∏–∞–Ω–∞ –≤ –º–µ—Ç–æ–¥–µ –ù—å—é—Ç–æ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ —Å–æ–ø—Ä—è–∂–µ–Ω–Ω—ã—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ (Conjugate Gradient, CG) –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –≤ —à–∞–≥–µ –ù—å—é—Ç–æ–Ω–∞. –†–∞–∑—Ä–∞–±–æ—Ç–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `newton_method_cg`, –∫–æ—Ç–æ—Ä–∞—è –≤—ã—á–∏—Å–ª—è–µ—Ç —à–∞–≥ –ù—å—é—Ç–æ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É—è CG –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã $\nabla^2 f(x_k) d_k = - \nabla f(x_k), \; x_{k+1} = x_k + \alpha d_k$ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –≥–µ—Å—Å–∏–∞–Ω–æ–º. –í—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é [`jax.scipy.sparse.linalg.cg`](https://jax.readthedocs.io/en/latest/_autosummary/jax.scipy.sparse.linalg.cg.html). –ò—Ç–∞–∫, —Å–Ω–∞—á–∞–ª–∞ –≤—ã—á–∏—Å–ª–∏—Ç–µ –≥–µ—Å—Å–∏–∞–Ω, –∫–∞–∫ —ç—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ –≤ –∫–æ–¥–µ, –∑–∞—Ç–µ–º –ø–æ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ –≤ —ç—Ç–æ—Ç —Ä–µ—à–∞—Ç–µ–ª—å –ª–∏–Ω–µ–π–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. –°—Ä–∞–≤–Ω–∏—Ç–µ –µ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å –æ–±—ã—á–Ω—ã–º –º–µ—Ç–æ–¥–æ–º –ù—å—é—Ç–æ–Ω–∞.
    
    7. (4 –±–∞–ª–ª–∞) –¢–µ–ø–µ—Ä—å —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –≤–µ—Ä—Å–∏—é –º–µ—Ç–æ–¥–∞ –ù—å—é—Ç–æ–Ω–∞ –±–µ–∑ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≥–µ—Å—Å–∏–∞–Ω–∞ (HFN), –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≥–µ—Å—Å–∏–∞–Ω–∞ –Ω–∞ –≤–µ–∫—Ç–æ—Ä, –ø–æ–ª—É—á–∞–µ–º—ã–µ —Å –ø–æ–º–æ—â—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–∏—è. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è `jax.scipy.sparse.linalg.cg` –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é matvec, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞–ø—Ä—è–º—É—é –≤—ã—á–∏—Å–ª—è–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ª—é–±–æ–≥–æ –≤—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ $x$ –Ω–∞ –≥–µ—Å—Å–∏–∞–Ω. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ HFN –±–µ–∑ —è–≤–Ω–æ–≥–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã –≥–µ—Å—Å–∏–∞–Ω–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `newton_method_hfn`. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ autograd –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –≥–µ—Å—Å–∏–∞–Ω–∞ –Ω–∞ –≤–µ–∫—Ç–æ—Ä, –∫–∞–∫ —ç—Ç–æ –æ–ø–∏—Å–∞–Ω–æ [–∑–¥–µ—Å—å](https://iclr-blogposts.github.io/2024/blog/bench-hvp/). –°—Ä–∞–≤–Ω–∏—Ç–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –∑–∞—Ç—Ä–∞—Ç—ã –ø–∞–º—è—Ç–∏ —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è–º–∏.