---
title: Линейное программирование и симплекс-метод
author: Семинар
institute: Оптимизация для всех! ЦУ
format:
    beamer:
        pdf-engine: xelatex
        aspectratio: 169
        fontsize: 9pt
        section-titles: false
        incremental: false
        include-in-header: ../files/xeheader.tex  # 
---

# Линейное программирование 

## Линейное программирование. Общие формы

:::: {.columns}

::: {.column width="50%"}

Для некоторых векторов $c \in \mathbb{R}^n$, $b \in \mathbb{R}^m$ и матрицы $A \in \mathbb{R}^{m \times n}$


* Базовая форма задачи линейного программирования:
\begin{align*}
\tag{LP.Basic}
&\min_{x \in \mathbb{R}^n} c^{\top}x \\
\text{s.t. } & Ax \leq b\\
\end{align*}


* Стандартная форма задачи линейного программирования:
\begin{align*}
\tag{LP.Standard}
&\min_{x \in \mathbb{R}^n} c^{\top}x \\
\text{s.t. } & Ax = b\\
& x_i \geq 0, \; i = 1,\dots, n
\end{align*}


:::

::: {.column width="50%"}

![Иллюстрация задачи линейного программирования.](linear_programming_problem.pdf){width=250}

:::

::::


# Симплекс-метод

## Основы симплекс-метода
:::: {.columns}

::: {.column width="50%"}

![Основные понятия симплекс-метода.](LP_basis_ru.pdf){width=150}

:::

::: {.column width="50%"}

![Изменение базиса симплекс-метода.](LP_change_ru.pdf){width=150}

:::

::::

::: {.callout-note title="Основные понятия симплекс-метода"}

* **Базис** $B$ является подмножеством $n$ (целых) чисел между $1$ и $m$, таких что $\text{rank} A_B = n$. Обратите внимание, что мы можем связать подматрицу $A_B$ и соответствующую правую часть $b_B$ с базисом $B$. Также мы можем получить точку пересечения всех этих гиперплоскостей из базиса: $x_B = A^{-1}_B b_B$.
* Если $A x_B \leq b$, то базис $B$ является **допустимым**.
* Базис $B$ является **оптимальным**, если $x_B$ является оптимумом $\texttt{LP.Basic}$.

::: 



## Основы симплекс-метода
:::: {.columns}

::: {.column width="50%"}

![Основные понятия симплекс-метода.](LP_basis_ru.pdf){width=150}

:::

::: {.column width="50%"}

![Изменение базиса симплекс-метода.](LP_change_ru.pdf){width=150}

:::

::::

::: {.callout-note title="Интуиция симплекс-метода"}

* Алгоритм симплекс-метода последовательно перемещается по рёбрам многогранника, в каждой вершине выбирая ребро, которое обеспечивает наибольшее уменьшение величины $c^\top x$
* Процесс либо завершается в некоторой вершине, либо уходит по неограниченному ребру, что означает неограниченность задачи снизу ($-\infty$ оптимум)

::: 


## Основы симплекс-метода
:::: {.columns}

::: {.column width="50%"}

![Основные понятия симплекс-метода.](LP_basis_ru.pdf){width=150}

:::

::: {.column width="50%"}

![Изменение базиса симплекс-метода.](LP_change_ru.pdf){width=150}

:::

::::


::: {.callout-tip title="Существование решения стандартной задачи линейного программирования"}

1. Если стандартная задача линейного программирования имеет непустое допустимое множество, то существует по крайней мере одна допустимая точка базиса
1. Если стандартная задача линейного программирования имеет решения, то по крайней мере одно из таких решений является оптимальной точкой базиса.
1. Если стандартная задача линейного программирования является допустимой и ограниченной, то она имеет оптимальное решение.

::: 



## Основы симплекс-метода
:::: {.columns}

::: {.column width="50%"}

![Основные понятия симплекс-метода.](LP_basis_ru.pdf){width=150}

:::

::: {.column width="50%"}

![Изменение базиса симплекс-метода.](LP_change_ru.pdf){width=150}

:::

::::

::: {.callout-tip title="Теорема об оптимуме в вершине"}

Пусть $\lambda_B$ будут координатами нашего вектора $c$ в базисе $B$:
$$
\lambda^\top_B A_B = c^\top \leftrightarrow \lambda^\top_B = c^\top A_B^{-1}
$$

Если все компоненты $\lambda_B$ неотрицательны и $B$ является допустимым, то $B$ является оптимальным. 

::: 



<!-- # LP Problems Examples

## LP Problems Examples. Klee Minty example
In the following problem simplex algorithm needs to check $2^n - 1$ vertexes with $x_0 = 0$:

:::: {.columns}

::: {.column width="50%"}

\begin{align*} & \max_{x \in \mathbb{R}^n} 2^{n-1}x_1 + 2^{n-2}x_2 + \dots + 2x_{n-1} + x_n\\
\text{s.t. } & x_1 \leq 5\\
& 4x_1 + x_2 \leq 25\\
& 8x_1 + 4x_2 + x_3 \leq 125\\
& \ldots\\
& 2^n x_1 + 2^{n-1}x_2 + 2^{n-2}x_3 + \ldots + x_n \leq 5^n\ & x \geq 0
\tag{Klee-Minty Problem}
\end{align*}

:::

::: {.column width="50%"}

![Convergense of Simplex Algorithm for the Klee-Minty Problem.](linear_programming_examples_klee_minty.pdf){width=250}

Open [\faPython Relevant Collab](https://colab.research.google.com/github/MerkulovDaniil/optim/blob/master/assets/Notebooks/LP.ipynb#scrollTo=GrKuLNXYik8V)

:::

:::: -->

# Примеры задач линейного программирования

## Примеры задач линейного программирования. Производственные планы

Предположим, вы думаете о том, чтобы начать бизнес по производству *Продукта X*. 

Давайте найдем максимальную недельную прибыль для вашего бизнеса в [\faPython Production Plan Problem](https://colab.research.google.com/github/MerkulovDaniil/optim/blob/master/assets/Notebooks/LP.ipynb#scrollTo=-VNwdz5RDiYu).


# Максимальный поток и минимальный разрез

## Пример задачи о максимальном потоке

:::: {.columns align=top}

::: {.column width="40%"}
![](maxflow.pdf){align-vertical="top"}

Узлы представляют собой маршрутизаторы, рёбра представляют собой каналы связи; каждому узлу соответствует пропускная способность — узел 1 может общаться с узлом 2 до 6 Мбит/с, узел 2 может общаться с узлом 4 до 2 Мбит/с и т.д.
:::

. . .

::: {.column width="60%"}
**Вопрос:**

* Сеть узлов и рёбер представляет собой каналы связи, каждый с указанной пропускной способностью.
* Пример: Может ли узел 1 (источник) общаться с узлом 6 (сток) на 6 Мбит/с? 12 Мбит/с? Какова максимальная скорость?

. . .

**Матрица пропускных способностей:**
$$
C = 
\begin{bmatrix}
0 & 6 & 0 & 0 & 6 & 0 \\
0 & 0 & 2 & 2 & 0 & 0 \\
0 & 0 & 0 & 2 & 0 & 7 \\
0 & 0 & 0 & 0 & 0 & 3 \\
0 & 0 & 0 & 5 & 0 & 2 \\
0 & 0 & 0 & 0 & 0 & 0
\end{bmatrix}
$$

. . .

**Матрица потоков:** $X[i,j]$ представляет собой поток от узла $i$ к узлу $j$.

. . .

**Ограничения:**
$$
0 \le X \qquad  X \le C
$$
$$
\text{Сохранение потока: } \sum_{j=2}^N X(i,j) = \sum_{k=1}^{N-1} X(k,i), \; i = 2, \dots, N-1
$$
:::
::::

## Пример задачи о максимальном потоке {.noframenumbering}

:::: {.columns align=top}

::: {.column width="40%"}
![](maxflow.pdf)

Данная настройка, когда все, что производится источником, будет идти в сток. Поток сети просто сумма всего, что выходит из источника:

$$\tag{Поток}
\sum_{i=2}^N X(1, i)
$$
:::

. . .

::: {.column width="60%"}

$$\tag{Задача о максимальном потоке}
\begin{aligned}
\text{максимизировать } & \langle X, S\rangle \\
\text{при ограничениях } -X &\le 0 \\
 X &\le C \\
\langle X, L_n\rangle &= 0, \; n = 2, \dots, N-1,
\end{aligned}
$$

$L_n$ состоит из одного столбца ($n$) единиц (кроме последней строки) минус одна строка (также $n$) единиц (кроме первого столбца).
$$
S =
\begin{bmatrix}
0 & 1 & \cdots & 1 \\
0 & 0 & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & 0
\end{bmatrix}, \quad
L_2 =
\begin{bmatrix}
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & -1 & \cdots & -1 \\
0 & 1 & 0 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 0 & \cdots & 0
\end{bmatrix}.
$$

:::
::::

## Пример задачи о минимальном разрезе

Разрез сети разделяет вершины на два множества: одно содержит источник (мы называем это множество $\mathcal{S}$), и одно содержит сток. Пропускная способность разреза — это общая величина рёбер, выходящих из $\mathcal{S}$ — мы разделяем множества, «отрезая поток» по этим рёбрам.

:::: {.columns align=top}

::: {.column width="50%"}
![](mincut1.pdf){width=80%}

Рёбра в разрезе: $1\to 2, 4 \to 6$, и $5 \to 6$. Пропускная способность этого разреза: $6 + 3 + 2 = 11$.

:::
::: {.column width="50%"}
![](mincut2.pdf){width=80%}

Рёбра в разрезе: $2\to3, 4 \to 6$, и $5 \to 6$. Пропускная способность этого разреза: $2 + 3 + 2 = 7$.

:::
::::


:::{.callout-theorem}
### Теорема о максимальном потоке и минимальном разрезе. 

Максимальное значение потока s-t равно минимальной пропускной способности всех s-t разрезов.
:::




## Примеры задач линейного программирования. Различные приложения

Посмотрите на различные практические приложения задач линейного программирования и симплекс-метода в [\faPython Related Collab Notebook ](https://colab.research.google.com/github/MerkulovDaniil/optim/blob/master/assets/Notebooks/LP.ipynb#scrollTo=GrKuLNXYik8V).
